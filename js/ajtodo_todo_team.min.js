jQuery(document).ready(function(t){var o=!1,a="",e=ajax_todo_info.filter_project,n=ajax_todo_info.statuses?t.parseJSON(ajax_todo_info.statuses):[],d=ajax_todo_info.todotypes?t.parseJSON(ajax_todo_info.todotypes):[],i=ajax_todo_info.currentuserstatus?t.parseJSON(ajax_todo_info.currentuserstatus):[],s=ajax_todo_info.members?t.parseJSON(ajax_todo_info.members):[],l=ajax_todo_info.category?t.parseJSON(ajax_todo_info.category):[],r="undefined"!=typeof todo_option_html?t(todo_option_html):"",c="undefined"!=typeof todo_view_html?t(todo_view_html):"",_="board"==ajax_todo_info.view,p="",f=[],u=[],v=[],j=[],m=[],h=ajax_todo_info.planorderset?t.parseJSON(ajax_todo_info.planorderset):"",y=[],g=[],x="",b=!1,w={},k="",C="",D="",S="N",T=0,N=[],Y=0,A=function(t){return""==t||null==t||null==t||null!=t&&"object"==typeof t&&!Object.keys(t).length};t.notifyDefaults({delay:ajax_todo_info.noti_delay}),t("#sjtodo_search").keydown(function(o){13==o.keyCode&&(a=t(this).val().trim(),B())}),t("#btnQuickTodo").click(function(o){if(t("#ajtodo_title").val().length>0){var a="action=ajtodo_team_todo_ajax";a+="&nonce="+ajax_todo_info.nonce,a+="&type=createtodo",a+="&pid="+t("#ajtodo_projectid").val(),a+="&title="+t("#ajtodo_title").val(),O(a,"post",function(o){t("#ajtodo_title").val("")},function(o){t.notify({message:res.msg},{type:"danger"})})}}),t("#ajtodo_todotitle").keydown(function(o){if(13==o.keyCode&&t(this).val().length>0){var a="action=ajtodo_team_todo_ajax";a+="&nonce="+ajax_todo_info.nonce,a+="&type=createtodo",a+="&pid="+e,a+="&todotype="+x,a+="&planid="+ajax_todo_info.planid,a+="&title="+t(this).val(),O(a,"post",function(o){t("#ajtodo_todotitle").val(""),_||(mt(),dt(),pt()),U(o.todoid,"add",function(o){"no"!=e&&""!=e&&o.data.projectid!=e||"no"==e&&null!=o.data.projectid||(m.push(o.data),_?(t("#ajtodo_todotitle_add").show(),t("#ajtodo_todotitle_input").hide(),t("#aj_status_open").append(tt(o.data)),Jt()):t("#todo_list").prepend(tt(o.data)))},function(t){})},function(t){})}});var O=function(o,a,e,n){t.ajax({url:ajax_todo_info.ajax_url,type:a,data:o,success:function(o){var a=t.parseJSON(o);a.result?(null!=a.msg&&t.notify({message:a.msg},{type:"success"}),e(a)):(t.notify({message:a.msg},{type:"danger"}),n(a.msg))}})},B=function(){!function(){t("#todo_list").empty(),t("#todo_done_list").empty();var o="<div class='text-center loadingbar'>";o+="<div class='spinner-border' role='status'>"+todo_lan.loadingtext+"</div> ",o+="</div>",t("#todo_list").append(o)}(),f=[],u=[],v=[];var o="action=ajtodo_team_todo_ajax";o+="&nonce="+ajax_todo_info.nonce,o+="&type=gettodolist",o+="&uid="+(null==ajax_todo_info.uid?"":ajax_todo_info.uid),o+="&pid="+e,o+="&planid="+ajax_todo_info.planid,o+="&filter_user="+(null==ajax_todo_info.user_filter?"":ajax_todo_info.user_filter),o+="&statuskey="+(null==ajax_todo_info.status_filter?"":ajax_todo_info.status_filter),o+="&search="+a,O(o+="&todotype="+p,"post",function(t){_t(),m=t.todolist,todo_status=t.statuses,_?z():J()},function(t){})};t(document).on("click","li.ajtodo-board-item",function(o){o.preventDefault();var a=t(this).attr("var"),e=m.find(t=>t.id===a);E(e,!1),t("#todpopview").modal("show")}),t("#todpopview").on("hidden.bs.modal",function(o){if(o.preventDefault(),t("#ajtodo_content .tmce-active").length>0){var a=t("#ajtodoTABoxSave").attr("sid");t("#ajtodoDivTABox").append(t(a).next()),t("#ajtodoDivTABox").append(t("#ajtodoTABoxSave"))}});var z=function(){t.each(t(".ajtodo-board-column-content"),function(o,a){var e=t(this).attr("var"),n=I(e),d=W(e);n.sort(function(t,o){return d.indexOf(t.id)-d.indexOf(o.id)}),t.each(n,function(o,a){t("#aj_status_"+e).append(tt(a))})})},I=function(o){return t.grep(m,function(t){return t.statuskey==o})},W=function(o){return t.grep(h,function(t){return t.status==o})},J=function(){t("#todo_list").empty(),t("#todo_done_list").empty(),t.each(todo_status,function(t,o){"S"==o.statustype&&(u.push(o),v.push(o)),"I"==o.statustype&&(f.push(o),v.push(o),u.push(o)),"D"==o.statustype&&(f.push(o),v.push(o)),"S"==o.statustype&&o.id,"D"==o.statustype&&o.id}),t.each(m,function(o,a){null!=a.donedated?t("#todo_done_list").append(tt(a)):t("#todo_list").append(tt(a))}),M()};t(document).on("click","ul.ajultodolist li a.todo_title",function(o){if(""==ajax_todo_info.isshortcode){o.preventDefault();var a=t(this).parent().attr("var"),e=m.find(t=>t.id===a);E(e)}});var X=function(o){o?(t(".todo_option_inline").removeClass("float-right"),t(".todo_option_inline_box").removeClass("float-right")):(t("#ajtodo_sv_action").find("#todo_ac_docs").empty(),t(".todo_option_inline").addClass("float-right"),t(".todo_option_inline_box").addClass("float-right"))},E=function(o,a=!0){b=!0,todoview=t(_?"#todpopview":c),t(r).find("#todo_ac_docs").empty(),t("#todoview").empty(),todoview.find("#ajtodo_doc_list_dv").empty(),todoview.find("#ajtodo_doc_list_dv_hr").hide(),_||X(!0),"Y"!=ajax_todo_info.is_only_view&&$(o);var n=Z(o.statuskey);"private"==ajax_todo_info.projecttype?todoview.find(".isonlyteam").hide():todoview.find(".isonlyteam").show(),todoview.find("#ajtodo_sv_tkey").html(o.tkey),todoview.find("#ajtodo_sv_status").text(n.name),todoview.find("#ajtodo_sv_regdate").text(todo_lan.regdate+" : "+o.regdate),null!=o.donedated&&todoview.find("#ajtodo_sv_donedate").text(todo_lan.donedate+" : "+o.donedated),todoview.find("#ajtodo_sv_status").addClass("badge-"+R(n.statustype)),todoview.find("#ajtodo_sv_title").html(wt(o,"title",!0,!ajax_todo_info.todoperms.includes("tp_todo_updateinfo")||""!=ajax_todo_info.freeze)),kt(todoview,o,"comment",!1,!ajax_todo_info.todoperms.includes("tp_todo_updateinfo")||""!=ajax_todo_info.freeze),todoview.find("#ajtodo_sv_author").html(Yt(o.id,o.authorid,!0,!1)),todoview.find("#ajtodo_sv_assignee").html(Yt(o.id,o.assignid,""!=ajax_todo_info.freeze,!1)),todoview.find("#ajtodo_sv_category").html(Dt(o,""!=ajax_todo_info.freeze)),todoview.find("#ajtodo_sv_todotype").html(Tt(o,""!=ajax_todo_info.freeze)),todoview.find("#ajtodo_sv_plan").html(St(o,""!=ajax_todo_info.freeze)),todoview.find("#ajtodo_sv_todolink").attr("href","/aj-todo/"+o.tkey),todoview.find("#ajtodo_sv_todolink").attr("target","_blank"),todoview.find("#ajtodo_sv_todolink").text(ajax_todo_info.siteurl+"/aj-todo/"+o.tkey),_||t("#ajtodo_todoview").append(t(c));var d="action=ajtodo_todo_ajax";if(d+="&nonce="+ajax_todo_info.nonce,d+="&type=getdocs",d+="&pid="+e,d+="&todo_id="+o.id,O(d,"post",function(o){t.each(o.docs,function(t,o){var a="";a+="<li class='list-gorup-item ajtodo_doc'>",a+="<a href='"+o.link+"' target='_blank'>",a+="<i class='fas fa-book' style='margin-right:4px;'></i>",a+=o.title,a+="</a>",a+="</li>",todoview.find("#ajtodo_doc_list_dv").append(a)}),o.docs.length>0&&todoview.find("#ajtodo_doc_list_dv_hr").show()},function(t){console.log(msg)}),t("#ajtodo_sv_action").empty(),""==ajax_todo_info.freeze){if(todoview.find("#ajtodo_vd_actionbox").show(),todoview.find("#ajtodo_sv_action").append(t(r)),console.log(ajax_todo_info.docperms),ajax_todo_info.docperms.includes("tp_doc_create")){var i="<a href='"+("post-new.php?post_type=ajtododoc&pid="+e+"&planid="+o.planid+"&tid="+o.id)+"' class='btn btn-dark btn_adddoc' target='_blank' style='margin-left:8px;'>";i+="<i class='fas fa-book'></i> "+todo_lan.adddoc+"</button>",todoview.find("#ajtodo_sv_action").find("#todo_ac_docs").append(i)}}else t("#ajtodo_vd_actionbox").hide();"closed"==o.statuskey?t("#ajtodo_todoview").css("background","inherit"):t("#ajtodo_todoview").css("background","#fff"),t("#ajtodo_todoview").css("border","1px solid lightgray"),_?(t(".todo_option_inline").removeClass("float-right"),t(".todo_option_inline_box").removeClass("float-right")):(t("#ajtodo_listview").hide(),t("#ajtodo_todoview").show())},L=function(){b=!1,X(!1),t("#ajtodo_todoview").hide(),t("#ajtodo_listview").show()};t(document).on("click","#ajtodo_sv_close",function(o){o.preventDefault(),_?t("#todpopview").modal("hide"):L()});var U=function(o,a,n,d){var i="action=ajtodo_todo_ajax";i+="&nonce="+ajax_todo_info.nonce,i+="&type=getsingletodo",i+="&pid="+e,O(i+="&todo_id="+o,"post",function(o){"up"==a&&t.each(m,function(t,a){a.id==o.data.id&&(m[t]=o.data)}),n(o)},function(t){console.log(msg)})},M=function(){t("#todo_done_list li").length>0?t(".donevw").show():t(".donevw").hide()},P=function(a){U(a.todoid,"",function(e){_||(mt(),dt());var n=tt(e.data);b&&E(e.data,_);var d=m.findIndex(t=>t.id==e.data.id);if(m[d]=e.data,_)t("li.ajtodo-board-item[var="+e.data.id+"]").remove(),t("#aj_status_"+e.data.statuskey).append(tt(e.data)),Jt();else{t("li.todo_list_item[var="+a.todoid+"]").replaceWith(n);var i=t("li.todo_list_item[var="+a.todoid+"]");"todo_list"==i.parent().attr("id")?null!=e.data.donedated&&t("#todo_done_list").prepend(i):null==e.data.donedated&&t("#todo_list").prepend(i),M();var s=!1;"Y"==ajax_todo_info.auto_done_hidden&&""!=ajax_todo_info.status_filter&&ajax_todo_info.status_filter!=e.data.statuskey&&(s=!0,t(n).fadeOut(1e3,function(){t(this).remove()})),!s&&o&&(Q(n,e.data),o=!1)}},function(o){t("li.todo_list_item[var="+a.todoid+"]").css("background","inherit")})},Q=function(o,a){""==ajax_todo_info.status_filter&&("I"==a.status_type?t.each(t("li.todo_list_item"),function(e,n){if(t(n).attr("var")!=a.id)return t(n).before(o),!1}):"D"==a.status_type?t.each(t("li.todo_list_item"),function(e,n){if(t(n).attr("var")!=a.id&&"D"==t(n).attr("status"))return t(n).before(o),!1}):"S"==a.status_type&&t.each(t("li.todo_list_item"),function(e,n){if(t(n).attr("var")!=a.id&&"S"==t(n).attr("status"))return t(n).before(o),!1}))},q=function(t){console.log(t)},R=function(t){switch(t){case"S":return"primary";case"I":return"warning";case"D":return"success"}},F=function(t,o,a,n){var d="action=ajtodo_team_todo_ajax";d+="&nonce="+ajax_todo_info.nonce,d+="&type=updatetodo",d+="&colval="+JSON.stringify(t),d+="&pid="+e,O(d+="&todo_id="+o,"post",a,q)},G=function(t,o,a,n,d){var i="action=ajtodo_team_todo_ajax";i+="&nonce="+ajax_todo_info.nonce,i+="&todo_id="+a,i+="&pid="+e,i+="&type=updatetodo",i+="&col="+t,i+="&val="+o,O(i+="&todo_id="+a,"post",n,q)},H=function(t){var o="";return"Y"==ajax_todo_info.set_show_todokey&&(o+="<span class='badge'>"+t.tkey+"</span>"),o+t.title},K=function(t){return"<i class='quickdo far "+n.find(o=>o.key===t.statuskey).icon+"'></i>"},V=function(t){return d.find(o=>o.key===t)},Z=function(t){return n.find(o=>o.key===t)},$=function(o){var a,e;t(r).attr("val",o.id),t(r).find("#todo_status").empty(),t(r).find("#todo_actions").empty(),ajax_todo_info.todoperms.includes("tp_todo_del")&&t(r).find("#todo_actions").append("<button type='button' class='btn btn-danger float-right ajtodo_del'>"+todo_lan.del+"</button>"),ajax_todo_info.todoperms.includes("tp_todo_status")&&(a=o,e=t(r),t.each(i,function(o,n){n.key==a.statuskey&&t.each(n.action,function(o,a){var n=Z(a),d="<button type='button' class='btn btn-info btn_status' val='"+a+"'><i class='far "+n.icon+"'></i> "+n.name+"</button>";t(e).find("#todo_status").append(d)})}))};t(document).on("click","#ajtodo_sv_action button.btn, #ajtodo_sv_inline_action button.btn",function(a){if(t(this).hasClass("ajtodo_del")&&(t(this).hasClass("ajtodo_del_now")?(t(c).find("#ajtodo_sv_close").click(),nt(t(r).attr("val"))):et(t(this),t(r).attr("val"))),t(this).hasClass("btn_status")){o=!0;var e={};"open"==t(this).attr("val")?e={statuskey:t(this).attr("val"),donedated:":_NULL_:"}:"closed"==t(this).attr("val")?(e={statuskey:t(this).attr("val"),donedated:":_NOW_:"},"Y"!=ajax_todo_info.set_autoclode_done||_||L()):e={statuskey:t(this).attr("val")},F(e,t(r).attr("val"),P)}});var tt=function(t){return _?ot(t):at(t)},ot=function(o){var a,e=V(o.todotype),n="<li class='ajtodo-board-item list-group-item-action list-group-item' ";n+=" style='border-radius: 4px !important;' ",""==ajax_todo_info.isshortcode&&(n+=" status='"+o.statuskey+"' "),null!=o.donedated&&(n+=" isdone "),n+=" skey='"+o.statuskey+"' ",n+=" var='"+o.id+"'></li>",a=t(n);var d="<div><div class='todotypepipe' style='margin-right: 4px;width : 25px;border : 1px solid "+e.color+";'></div>";if(""==ajax_todo_info.isshortcode?d+="<a href='#' class='"+(null!=o.donedated?"done":"")+"' style='font-size:14px !important'>"+o.title:d+="<a href='/aj-todo/"+o.tkey+"' class='"+(null!=o.donedated?"done":"")+"' style='font-size:14px !important'>"+o.title,null!=o.categorykey&&ajax_todo_info.set_show_category,d+="</a>",d+="</div>",d+="<div class='clearfix' style='margin-left:-2px;'>",o.donedated,""!=o.comment&&(d+="<i class='far fa-file-alt' style='margin-left:4px;margin-top: 8px;'></i>"),o.docs>0&&(d+="<i class='fas fa-book' style='margin-left:4px;margin-top: 8px;'></i>"),null!=o.assignid){var i="";t.each(s,function(t,a){a.id==o.assignid&&(i=a)});var l=i.avatar.replace("<img ","<img class='rounded-circle' title='"+i.name+"' ");d+="<div class='float-right inline_assignee'>"+(l=l.replace(/28/gi,"24"))+"</div>"}return d+="</div>",a.append(d),a},at=function(o){var a,e="<li class='todo_list_item list-group-item-action list-group-item' style='border-left : 3px solid "+V(o.todotype).color+";' ";""==ajax_todo_info.isshortcode&&(e+=" status='"+o.statuskey+"' "),e+=" var='"+o.id+"' planid='"+o.planid+"'></li>",a=t(e);var n,d,i="";(i=""==ajax_todo_info.isshortcode?"<a href='#' class='todo_title "+(null!=o.donedated?"done":"")+"'>"+K(o)+H(o):"<a href='/aj-todo/"+o.tkey+"' class='todo_title "+(null!=o.donedated?"done":"")+"'>"+K(o)+H(o),""!=o.comment&&(i+="<i class='far fa-file-alt' style='margin-left:4px;'></i>"),o.docs>0&&(i+="<i class='fas fa-book' style='margin-left:4px;'></i>"),null!=o.categorykey&&"Y"==ajax_todo_info.set_show_category)&&(i+="<kbd style='margin-left:8px;font-size:12px;background:#61a4cc'>"+(n=o.categorykey,l.find(t=>t.key===n)).name+"</kbd>");i+="</a>",a.append(i),null!=o.assignid&&a.append("<div class='clearfix float-right inline_assignee'>"+Yt(o.id,o.assignid,!0,!0)+"</div>"),null!=o.donedated&&a.append("<kbd class='clearfix float-right' style='padding:3px 4px;margin-right:4px;'>"+(d=o.donedated,moment(d)>moment().add(-3,"days")?moment(d).fromNow():moment(d).format("YYYY-MM-DD"))+"</kbd>"),a.mouseenter(function(){b||""==ajax_todo_info.freeze&&($(o),t(this).find("kbd.float-right").hide(),t(this).append(t(r)))}),a.mouseleave(function(){""==ajax_todo_info.freeze&&(t(this).find("kbd").show(),t(this).find(".todo_option_inline").remove())});var s=!1;return("Y"==ajax_todo_info.planview&&""==w.donedate||"0"==ajax_todo_info.planid||t.isEmptyObject(w))&&(s=!0),"Y"==ajax_todo_info.freeze&&(s=!1),s&&ajax_todo_info.planperms.includes("tp_plan_manage")&&(a.css("cursor","pointer"),a.attr("draggable",!0),a.on("dragstart",function(o){t(this).addClass("moving")}),a.on("dragend",function(o){t(this).removeClass("moving")}),a.mousedown(function(){k=t(this).attr("var"),C=t(this).attr("planid")})),a},et=function(o,a){"Y"==ajax_todo_info.del_noconfirm?nt(a):(t(o).text(todo_lan.delconfirm),t(o).addClass("ajtodo_del_now"))},nt=function(o){var a="action=ajtodo_team_todo_ajax";a+="&nonce="+ajax_todo_info.nonce,a+="&type=deltodo",a+="&pid="+e,a+="&todo_id="+t(r).attr("val"),O(a,"post",function(o){_?(t("li.ajtodo-board-item[var="+o.todoid+"]").remove(),t("#todpopview").modal("hide"),Jt()):(mt(),dt(),t(".ajultodolist li[var="+o.todoid+"]").addClass("list-group-item-danger").attr("disabled",""),t(".ajultodolist li[var="+o.todoid+"]").fadeOut(1e3,function(){t(this).remove()}))},function(t){err(t)})};t("#ajtodo_todolist_user_filter button").click(function(o){o.preventDefault(),ajax_todo_info.user_filter=t(this).attr("val"),B()});var dt=function(){if("N"!=ajax_todo_info.progressview){y=[];var o="action=ajtodo_team_todo_ajax";o+="&nonce="+ajax_todo_info.nonce,o+="&uid="+ajax_todo_info.uid,o+="&pid="+e,o+="&planid="+ajax_todo_info.planid,O(o+="&type=getprogress","post",function(o){T=0;var a=0,e=0;if(t.each(o.statuses,function(t,o){var n=Z(o.statuskey);switch(n.statustype){case"S":a+=parseInt(o.cnt);break;case"I":parseInt(o.cnt);break;case"D":e+=parseInt(o.cnt)}y.push({statuskey:o.statuskey,name:n.name,statustype:n.statustype,count:parseInt(o.cnt)}),T+=parseInt(o.cnt)}),it(0==T),T>0){var n=100*a/T,d=100*e/T,i=100-n-d;t("#ajtodo_userprogress .bg-primary").css("width",n+"%"),t("#ajtodo_userprogress .bg-warning").css("width",i+"%"),t("#ajtodo_userprogress .bg-success").css("width",d+"%")}lt()},function(t){})}},it=function(o){o?(t("#ajtodo_top_filter_box_empty").show(),t("#ajtodo_todolist_status_filter").hide(),t("#ajtodo_userprogress").hide()):(t("#ajtodo_top_filter_box_empty").hide(),t("#ajtodo_todolist_status_filter").show(),t("#ajtodo_userprogress").show())};t(document).on("click","#sjtodo_nowstatusinfo button",function(o){o.preventDefault(),st(),ajax_todo_info.status_filter==t(this).attr("val")?ajax_todo_info.status_filter="":(t(this).addClass("active"),ajax_todo_info.status_filter=t(this).attr("val")),B()});var st=function(){t.each(t("#sjtodo_nowstatusinfo button"),function(o,a){t(a).removeClass("active")})},lt=function(){t("#sjtodo_nowstatusinfo").empty(),t.each(y,function(o,a){if("S"==a.statustype){var e="<button type='button' id='ajtodo_todolist_status_open' val='"+a.statuskey+"'";e+=" class='btn btn-primary "+(ajax_todo_info.status_filter==a.statuskey?"active":"")+"'>",e+=a.name+" <span class='badge badge-light'>"+a.count+"</span></button>",t("#sjtodo_nowstatusinfo").append(e)}}),t.each(y,function(o,a){if("I"==a.statustype){var e="<button type='button' id='ajtodo_todolist_status_open' val='"+a.statuskey+"'";e+=" class='btn btn-warning "+(ajax_todo_info.status_filter==a.statuskey?"active":"")+"'>",e+=a.name+" <span class='badge badge-light'>"+a.count+"</span></button>",t("#sjtodo_nowstatusinfo").append(e)}}),t.each(y,function(o,a){if("D"==a.statustype){var e="<button type='button' id='ajtodo_todolist_status_open' val='"+a.statuskey+"'";e+=" class='btn btn-success "+(ajax_todo_info.status_filter==a.statuskey?"active":"")+"'>",e+=a.name+" <span class='badge badge-light'>"+a.count+"</span></button>",t("#sjtodo_nowstatusinfo").append(e)}})},rt=function(o){var a="";return t.each(j,function(t,e){e.id==o&&(a=e.title)}),a},ct=function(){t("#todo_filter_project").empty();var o="<button type='button' class='btn btn-danger dropdown-toggle' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>"+("no"==e?todo_lan.noproject:e?rt(e):todo_lan.showall)+"</button>";o+="<div class='dropdown-menu'>",t.each(j,function(t,a){e!=a.id&&(o+="\t<a class='dropdown-item todo_project' href='' val='"+a.id+"'>"+a.title+"</a>")}),o+="\t<div class='dropdown-divider'></div>","no"!=e&&(o+="\t<a class='dropdown-item todo_project' href='' val='no'>"+todo_lan.noproject+"</a>"),""!=e&&(o+="\t<a class='dropdown-item todo_project' href='' val=''>"+todo_lan.showall+"</a>"),o+="</div>",t("#todo_filter_project").append(o),t("#todo_filter_project a").click(function(o){o.preventDefault(),e=t(this).attr("val"),ct(),B(),dt()})},_t=function(){var o="[ajtodo uid="+ajax_todo_info.userid;""!=e&&(o+=" project="+e),""!=ajax_todo_info.status_filter&&(o+=" status="+ajax_todo_info.status_filter),""!=a&&(o+=" search="+a),o+="]",t("#ajtodo_todo_sc").html("<kbd>"+o+"</kbd>")},pt=function(){y=[];var t="action=ajtodo_team_todo_ajax";t+="&nonce="+ajax_todo_info.nonce,t+="&uid="+ajax_todo_info.uid,t+="&pid="+e,t+="&planid="+ajax_todo_info.planid,O(t+="&type=gettodotypes","post",function(t){g=t.todotypes,ft()},function(t){})};t(document).on("click",".seltodotype",function(o){x=t(this).attr("val");var a=V(x);t("#ajtodo_set_nowtodotype").text(a.name),t("#ajtodo_set_nowtodotype").css("background",a.color),t("#ajtodo_set_nowtodotypelist").empty(),t.each(d,function(o,a){if(a.key!=x){var e="<a class='fs12 pt8 pb8 dropdown-item seltodotype' href='#' ";e+=" style='background:"+a.color+"' val='"+a.key+"'>"+a.name+"</a>",t("#ajtodo_set_nowtodotypelist").append(e)}})});var ft=function(){t("#ajtodo_todotypelist").empty();var o=""==p?"":V(p);""==p?(t("#ajtodo_now_todotype").css("background","#fff"),t("#ajtodo_now_todotype").css("color","#000"),t("#ajtodo_now_todotype").attr("val",""),t("#ajtodo_now_todotype").text(todo_lan.todotype+" : "+todo_lan.all)):(t("#ajtodo_now_todotype").css("background",o.color),t("#ajtodo_now_todotype").css("color","#fff"),t("#ajtodo_now_todotype").attr("val",""),t("#ajtodo_now_todotype").text(todo_lan.todotype+" : "+o.name)),t.each(d,function(o,a){var e=0;t.each(g,function(t,o){a.key==o.todotype&&(e=o.cnt)});var n="<a class='fs12 pt8 pb8 dropdown-item btn-sm' style='border-left:8px solid "+a.color+"' href='#' val='"+a.key+"'>";n+=a.name;var d=t(n+="<span class='badge float-right fs12'>"+e+"</span></a>");t("#ajtodo_todotypelist").append(d)}),""!=p&&(t("#ajtodo_todotypelist").append("<div class='dropdown-divider ajtodoonlytodotypeok' style='margin:0'></div>"),t("#ajtodo_todotypelist").append("<a class='fs12 pt8 pb8 dropdown-item btn-sm ajtodoonlytodotypeok' style='border-left:8px solid #fff' val='' href='#'>"+todo_lan.all+"</a>"))};t(document).on("click","#ajtodo_todotypelist a",function(o){o.preventDefault(),p=t(this).attr("val"),ft(),B()});var ut=function(o){var a="<div class='card plancard ";o.donedate=null!=o.donedate?o.donedate:"",o.realstartdate=null!=o.realstartdate?o.realstartdate:"",ajax_todo_info.planid==o.id&&(a+=" text-white bg-success"),o.donedate&&(a+=" text-light bg-dark"),a+="' donedate='"+o.donedate+"' ",a+="' realstartdate='"+o.realstartdate+"' ","N"==S&&o.donedate&&(a+="' style='display:none;' "),a+="' val='"+o.id+"'>",a+="<div class='card-header'>",o.realstartdate&&(a+="<i class='fas fa-play'></i> "),a+=o.plantitle;var n="/wp-admin/admin.php?page=ajtodo_admin_project&ptype=team&ajtodo_type=board&plankey="+o.id+"&pid="+e;if(0==o.id||o.donedate||(a+="<a href='"+n+"' class='btn btn-sm text-white btn-dark float-right' style='margin:-4px;'>",a+="<i class='fas fa-chalkboard'></i>",a+="</a>"),a+="</div>",o.donedate,a+="<div class='card-body'>",o.id>0&&("Y"==o.ising&&(a+="\t<p class='card-text'>"+todo_lan.ing+"</p>"),a+="\t<p class='card-text'>"+todo_lan.finday+" : "+moment(o.finishdate).fromNow()+"</p>",a+="\t<p class='card-text'>"+o.startdate.substring(0,10)+" ~ "+o.finishdate.substring(0,10)+"</p>"),a+=function(o){var a=0,e=0;o.length>0&&t.each(o,function(t,o){e+=parseInt(o.cnt),"O"==o.statuskey&&parseInt(o.cnt),"D"==o.statuskey&&(a=parseInt(o.cnt))}),T+=e;var n=e>0?100*a/e:0,d="<p class='card-text'>"+todo_lan.done+" / "+todo_lan.all;return d+="<span class='float-right'>"+a+" / "+e+"</span></p>",d+="<div class='progress'>",d+="<div class='progress-bar bg-warning' role='progressbar' aria-valuemin='0' aria-valuemax='100' ",d+="style='width: "+n+"%' aria-valuenow='"+n+"'></div>",d+="</div>"}(o.cnt),a+="</div>",0!=o.id&&ajax_todo_info.planperms.includes("tp_plan_manage")&&""==ajax_todo_info.freeze){a+="<div class='card-footer'>";var d="?page=ajtodo_admin_project&ptype=team&ajtodo_type=plan&act=addplan&plankey="+o.id+"&pid="+e;o.donedate||("Y"==o.ising?a+="<a href='#' class='mt8 btn btn-dark btn-sm planstop' val='"+o.id+"' style='margin:0px'><i class='fas fa-pause'></i> "+todo_lan.stop+"</a>":a+="<a href='#' class='mt8 btn btn-dark btn-sm planstart' val='"+o.id+"' style='margin:0px'><i class='fas fa-play'></i> "+todo_lan.start+"</a>"),a+="<a href='"+d+"' class='mt8 btn btn-dark btn-sm float-right' style='margin:0px'><i class='fas fa-cog'></i></a>",a+="</div>"}return a+="</div>"};t(document).on("click",".planstop",function(o){o.preventDefault();var a=t(this).attr("val"),e="action=ajtodo_team_todo_ajax";e+="&nonce="+ajax_todo_info.nonce,e+="&type=planstop",e+="&planid="+a,e+="&pid="+ajax_todo_info.filter_project,O(e,"post",function(t){mt()},function(t){console.log(t)})}),t(document).on("click",".planstart",function(o){o.preventDefault();var a=t(this).attr("val"),e="action=ajtodo_team_todo_ajax";e+="&nonce="+ajax_todo_info.nonce,e+="&type=planstart",e+="&planid="+a,e+="&pid="+ajax_todo_info.filter_project,O(e,"post",function(t){mt()},function(t){console.log(t)})});t(document).on("click","#tglplan",function(o){"Y"==(S="N"==S?"Y":"N")?(ajax_todo_info.planperms.includes("tp_plan_create")?t(this).find("i").removeClass("fa-eye-slash").addClass("fa-eye"):t(this).html("<i class='far fa-eye-slash'></i> "+todo_lan.show_all_plan),t.each(t("#aj_planlist .bg-dark"),function(o,a){t(a).show()})):(ajax_todo_info.planperms.includes("tp_plan_create")?t(this).find("i").removeClass("fa-eye").addClass("fa-eye-slash"):t(this).html("<i class='far fa-eye-slash'></i> "+todo_lan.show_ing_plan),t.each(t("#aj_planlist .bg-dark"),function(o,a){t(a).hide()}))});var vt=function(o){t.each(N,function(t,a){a.id==o&&(w=a)})},jt=function(){t("#todo_filter_plan").empty();var o="";""==ajax_todo_info.planid?o=todo_lan.all:(vt(ajax_todo_info.planid),o=""!=w.donedate?"<i class='far fa-check-circle'></i> ":"Y"==w.ising?"<i class='fas fa-play'></i> ":"<i class='far fa-circle'></i> ",o+=w.plantitle);var a="<button type='button' class='btn btn-info dropdown-toggle' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>";a+=o,a+="</button>",a+="<div class='dropdown-menu'>",t.each(N,function(t,o){null==o.donedate&&o.id!=ajax_todo_info.planid&&(a+="\t<a class='fs12 pt8 pb8 dropdown-item todo_plan' href='#' val='"+o.id+"'>",""!=o.donedate?a+="<i class='far fa-check-circle'></i> ":"Y"==o.ising?a+="<i class='fas fa-play'></i> ":a+="<i class='far fa-circle'></i> ",a+=o.plantitle,a+="</a>")}),""!=ajax_todo_info.planid&&(a+="\t<div class='dropdown-divider'></div>",a+="\t<a class='fs12 pt8 pb8 dropdown-item todo_plan' href='#' val=''>"+todo_lan.all+"</a>"),a+="</div>",t("#todo_filter_plan").append(a),t("#todo_filter_plan a.todo_plan").click(function(o){o.preventDefault(),ajax_todo_info.planid=t(this).attr("val"),pt(),dt(),jt(),B()})},mt=function(){T=0;var o="action=ajtodo_team_todo_ajax";o+="&nonce="+ajax_todo_info.nonce,o+="&type=getplanlist",o+="&pid="+ajax_todo_info.filter_project,O(o,"post",function(o){N=o.planlist,"Y"==ajax_todo_info.planview?(t("#aj_todolist").empty(),t("#aj_planlist").empty(),t.each(N,function(o,a){"Y"==a.ising&&t("#aj_planlist").append(ut(a))}),t.each(N,function(o,a){0==a.id&&t("#aj_planlist").append(ut(a))}),t.each(N,function(o,a){0!=a.id&&A(a.donedate)&&"N"==a.ising&&t("#aj_planlist").append(ut(a))}),t.each(N,function(o,a){0==a.id||A(a.donedate)||"N"!=a.ising||t("#aj_planlist").append(ut(a))}),vt(ajax_todo_info.planid),t("#aj_planlist .card-body").click(function(){t.each(t("#aj_planlist .card.plancard"),function(o,a){t(a).removeClass("text-white").removeClass("bg-success")});var o=t(this).parent().attr("val");t(this).parent().addClass("text-white").addClass("bg-success"),ajax_todo_info.planid!=o&&L(),ajax_todo_info.planid=o,it(!1),vt(o),B()}),t("#aj_planlist .card.plancard").on("dragover",yt).on("dragleave",ht).on("drop",xt).on("dragenter",gt),it(0==T)):jt()},function(t){console.log(t)})},ht=function(o){o.stopPropagation(),o.preventDefault(),t(o.currentTarget).removeClass("dropover")},yt=function(o){o.stopPropagation(),o.preventDefault(),t(o.currentTarget).addClass("dropover"),o.originalEvent.dataTransfer.dropEffect="move"},gt=function(o){o.preventDefault();var a=t(o.currentTarget).attr("val");void 0!==a&&!1!==a&&(D=a)},xt=function(o,a){t(o.currentTarget).hasClass("bg-dark")||t.isNumeric(k)&&t.isNumeric(D)&&C!=D&&F({planid:D},k,bt)},bt=function(o){mt(),t(".ajultodolist li[var='"+k+"']").remove()};t("#addplan").click(function(){var t="?page=ajtodo_admin_project&ptype=team&ajtodo_type=plan&act=addplan&pid="+ajax_todo_info.filter_project;window.location=t});var wt=function(t,o,a,e){var n="",d="";switch(o){case"title":d=t.title,""}return e?n=d:(n="<div class='ajtodo_settext_show'>"+d+"</div>",n+="<input type='text' style='display:none;' class='form-control ajtodo_settext_edit_box' ",n+=a?" nvalid='Y' ":"",n+=" col='"+o+"' tid='"+t.id+"' value='"+d+"'>"),n},kt=function(o,a,e,n,d){o.find("#ajtodo_content").empty();var i="",s="",l="";switch(e){case"comment":s=a.comment,l=todo_lan.nocontent}d?i=""==s?todo_lan.nocontent:s:(i="<div class='fs14 ajtodo_settextarea_show' id='sid_"+a.id+"'>"+(""!=s?s:l)+"</div>",t("#ajtodoTABoxSave").attr("col",e),t("#ajtodoTABoxSave").attr("tid",a.id),t("#ajtodoTABoxSave").attr("sid","#sid_"+a.id)),o.find("#ajtodo_content").append(i)};t(document).on("click","#ajtodoTABoxSave",function(o){o.preventDefault(),function(){var o=t("#ajtodoTABoxSave").attr("sid"),a=tinymce.activeEditor.getContent();if(t(o).show(),t("#ajtodoDivTABox").append(t(o).next()),t("#ajtodoDivTABox").append(t("#ajtodoTABoxSave")),a!=t(o).html()){var e=t("#ajtodoTABoxSave").attr("col"),n=t("#ajtodoTABoxSave").attr("tid"),d=""==a?todo_lan.nocontent:a;t(o).html(d),G(e,a,n,Ct)}}()}),t(document).on("click",".todo_singleview div.ajtodo_settextarea_show",function(o){o.preventDefault(),t(this).hide(),t(this).parent().append(t("#ajtodoDivTABox").contents()),tinymce.execCommand("mceRemoveEditor",!1,"ajtodoTABox"),tinymce.execCommand("mceAddEditor",!1,"ajtodoTABox");var a=t(this).text()==todo_lan.nocontent?"":t(this).html();tinymce.activeEditor.setContent(a)}),t(document).on("click",".todo_singleview div.ajtodo_settext_show",function(o){o.preventDefault(),t(this).hide(),t(this).next().val(t(this).text()==todo_lan.nocontent?"":t(this).html().replace(/<br ?\/?>/g,"\n")),t(this).next().show(),t(this).next().focus()});t(document).on("focusout",".todo_singleview input.ajtodo_settext_edit_box",function(o){if(o.preventDefault(),"Y"==t(this).attr("nvalid")&&""==t(this).val().trim())return t(this).hide(),t(this).prev().show(),void t(this).val(t(this).prev().val());!function(t,o){t.hide(),t.prev().show();var a=t.prev().text();if((a=a==todo_lan.nocontent?"":a)!=t.val().replace(/\n/g,"")){var e=t.attr("col"),n=t.attr("tid");if(t.is("input"))t.prev().text(t.val());else{var d=""==t.val()?todo_lan.nocontent:t.val().replace(/\n/g,"<br />");t.prev().html(d)}G(e,t.val(),n,Ct)}}(t(this))});var Ct=function(o){U(o.todoid,"up",function(o){var a=tt(o.data);_?t("li.ajtodo-board-item[var="+o.data.id+"]").replaceWith(a):t("li.todo_list_item[var="+o.data.id+"]").replaceWith(a)},function(t){console.log(t)})};t(document).on("click",".todo_singleview a.categorysel",function(o){o.preventDefault();var a=t(this).attr("val"),e=t(this).attr("tid");G("categorykey",a,e,Ot)});var Dt=function(o,a){var e="",n="";return t.each(l,function(t,a){a.key==o.categorykey&&(n=a)}),a||0==l.length?(e+="<button class='btn btn-sm disable ajtodo_usersmallcard' data-toggle='tooltip' data-placement='top' title='"+n.name+"' style='padding:0px;height: 30px;' type='button' >",e+=""!=n?n.name:todo_lan.nocategorykey,e+="</button>"):(e="<div class='btn-group'>",e+="<button class='btn btn-sm dropdown-toggle ajtodo_usersmallcard' ",e+=" style='padding:0px;height: 30px;' ",e+=" type='button' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>",e+=""!=n?n.name:todo_lan.nocategorykey,e+="</button>",e+="<div class='dropdown-menu'>",t.each(l,function(t,a){a.key!=o.categorykey&&(e+="<a class='dropdown-item categorysel' href='#' val='"+a.key+"' tid='"+o.id+"'>",e+=a.name,e+="</a>")}),""!=n&&(e+="<div class='dropdown-divider'></div>",e+="<a class='dropdown-item categorysel' href='#' val='' tid='"+o.id+"'>"+todo_lan.nocategorykey+"</a>"),e+="</div>",e+="</div>"),e},St=function(o,a){var e="",n="";return t.each(N,function(t,a){a.id==o.planid&&(n=a)}),a?(e+="<button class='btn btn-sm disable ajtodo_usersmallcard' style='padding:0px;height: 30px;' type='button' >",""!=type?e+=n.plantitle:e+=todo_lan.noplan,e+="</button>"):(e="<div class='btn-group'>",e+="<button class='btn btn-sm dropdown-toggle ajtodo_usersmallcard' ",e+=" style='padding:0px;height: 30px;' ",e+=" type='button' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>",e+=""!=n?n.plantitle:todo_lan.noplan,e+="</button>",e+="<div class='dropdown-menu'>",t.each(N,function(t,a){""==a.donedate&&a.id!=o.planid&&(e+="<a class='dropdown-item uplan' href='#' val='"+a.id+"' tid='"+o.id+"'>",e+=a.plantitle,e+="</a>")}),e+="</div>",e+="</div>"),e},Tt=function(o,a){var e="",n="";return t.each(d,function(t,a){a.key==o.todotype&&(n=a)}),a?(e+="<button class='btn btn-sm disable ajtodo_usersmallcard' style='padding:0px;height: 30px;' type='button' >",e+=""!=n?n.name:todo_lan.nocategorykey,e+="</button>"):(e="<div class='btn-group'>",e+="<button class='btn btn-sm dropdown-toggle ajtodo_usersmallcard' ",e+=" style='padding:0px;height: 30px;' ",e+=" type='button' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>",e+=""!=n?n.name:todo_lan.nocategorykey,e+="</button>",e+="<div class='dropdown-menu'>",t.each(d,function(t,a){a.key!=o.todotype&&(e+="<a class='dropdown-item todotypesel' href='#' val='"+a.key+"' tid='"+o.id+"'>",e+=a.name,e+="</a>")}),e+="</div>",e+="</div>"),e};t(document).on("click",".todo_singleview a.todotypesel",function(o){o.preventDefault();var a=t(this).attr("val"),e=t(this).attr("tid");G("todotype",a,e,Bt)});var Nt,Yt=function(o,a,e,n){var d="",i="";return t.each(s,function(t,o){o.id==a&&(i=o)}),e?n?d+=i.avatar.replace("<img ","<img class='rounded-circle' title='"+i.name+"' "):(d+="<button class='btn btn-sm disable ajtodo_usersmallcard' style='padding:0px' type='button' >",d+=""!=i?i.avatar.replace("<img ","<img class='rounded-circle'")+" "+i.name:todo_lan.noassignee,d+="</button>"):(d="<div class='btn-group'>",d+="<button class='btn btn-sm dropdown-toggle ajtodo_usersmallcard' ",d+=""!=i?" style='padding:0px' ":" style='padding:0px;height: 30px;' ",d+=" type='button' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>",d+=""!=i?n?i.avatar.replace("<img ","<img class='rounded-circle'"):i.avatar.replace("<img ","<img class='rounded-circle'")+" "+i.name:todo_lan.noassignee,d+="</button>",d+="<div class='dropdown-menu'>",t.each(s,function(t,e){e.id!=a&&(d+="<a class='dropdown-item usel' href='#' val='"+e.id+"' tid='"+o+"'>",d+=e.avatar.replace("<img ","<img class='rounded-circle' ")+" ",d+=e.name,d+="</a>")}),""!=i&&(d+="<div class='dropdown-divider'></div>",d+="<a class='dropdown-item usel' href='#' val='' tid='"+o+"'>"+todo_lan.noassignee+"</a>"),d+="</div>",d+="</div>"),d},At=function(o){U(o.todoid,"up",function(o){var a=tt(o.data);_?t("li.ajtodo-board-item[var="+o.data.id+"]").replaceWith(a):t("li.todo_list_item[var="+o.data.id+"]").replaceWith(a),t("#ajtodo_sv_assignee").html(Yt(o.data.id,o.data.assignid,!1,!1))},function(t){console.log(t)})},Ot=function(o){U(o.todoid,"up",function(o){var a=tt(o.data);_?t("li.ajtodo-board-item[var="+o.data.id+"]").replaceWith(a):t("li.todo_list_item[var="+o.data.id+"]").replaceWith(a),t("#ajtodo_sv_category").html(Dt(o.data,!1))},function(t){console.log(t)})},Bt=function(o){U(o.todoid,"up",function(o){var a=tt(o.data);_?t("li.ajtodo-board-item[var="+o.data.id+"]").replaceWith(a):t("li.todo_list_item[var="+o.data.id+"]").replaceWith(a),t("#ajtodo_sv_todotype").html(Tt(o.data,!1))},function(t){console.log(t)})},zt=function(o){bt(),U(o.todoid,"up",function(o){console.log(o.data),_?(t("li.ajtodo-board-item[var="+o.data.id+"]").remove(),t("#todpopview").modal("hide"),Jt()):t("#ajtodo_sv_plan").html(St(o.data,""!=ajax_todo_info.freeze))},function(t){console.log(t)})};t(document).on("click",".todo_singleview a.uplan",function(o){o.preventDefault();var a=t(this).attr("val"),e=t(this).attr("tid");F({planid:a},e,zt)}),t(document).on("click",".todo_singleview a.usel",function(o){o.preventDefault();var a=t(this).attr("val"),e=t(this).attr("tid");G("assignid",a,e,At)}),"Y"!=ajax_todo_info.is_only_view&&(mt(),st(),pt(),dt(),""==ajax_todo_info.filter_project&&(Nt="action=ajtodo_team_todo_ajax",Nt+="&nonce="+ajax_todo_info.nonce,Nt+="&pid="+e,O(Nt+="&type=getprojects","post",function(t){j=t.projects,ct()},function(t){})),B(),moment.locale(ajax_todo_info.locale),t("#ajtodo_hello_title").text(ajax_todo_info.hello_title),t("#ajtodo_hello_msg").html(ajax_todo_info.hello_msg),t("#ajtodo_alert_close_big").click(function(){t(".ajtodo_hello").slideUp(1e3,function(){t(this).remove()});var o="action=ajtodo_team_todo_ajax";o+="&nonce="+ajax_todo_info.nonce,o+="&type=setcookie",o+="&key=hidehello",O(o+="&val=Y","post",function(t){},function(t){})}));var It=function(){Y=t(this).height()-t("#aj_board_main").offset().top-t("#wpfooter").height()-8,t("#aj_board_main").height(Y),t("#ajtodo_project_set").width(t(this).width()-t("#aj_board_main").offset().left-24),t.each(t(".ajtodo-board-column-content"),function(o,a){t(a).css("max-height",Y-76)})},Wt=function(o){U(o.todoid,"up",function(o){t("li.ajtodo-board-item[var="+o.data.id+"]").attr("status",o.data.statuskey),t("li.ajtodo-board-item[var="+o.data.id+"]").attr("skey",o.data.statuskey)},function(){})},Jt=function(){h=[],t.each(t(".ajtodo-board-column-content"),function(o,a){var e={status:t(a).attr("var"),list:[]};t.each(t(a).find(".ajtodo-board-item"),function(o,a){t(a).attr("var")&&e.list.push(t(a).attr("var"))}),h.push(e)});var o="action=ajtodo_team_todo_ajax";o+="&nonce="+ajax_todo_info.nonce,o+="&type=planorder",o+="&orders="+JSON.stringify(h),o+="&planid="+ajax_todo_info.planid,O(o,"post",function(){},function(){})};if(_){t("#ajtodo_todotitle_add").click(function(o){t("#ajtodo_todotitle").val(""),t("#ajtodo_todotitle_input").show(),t("#ajtodo_todotitle").focus(),t(this).hide()}),t("#ajtodo_todotitle").focusout(function(o){t("#ajtodo_todotitle_add").show(),t("#ajtodo_todotitle_input").hide()}),t("#wpfooter").hide(),t("#adminmenumain").hide(),t("#wpcontent").css("margin-left","0px"),t("#ajtodo_project_set").css("overflow-x","auto"),t(".ajtodo-board-item").sortable({revert:"invalid"});var Xt="",Et=[];t(".ajtodo-board-column-content").sortable({connectWith:".ajtodo-board-column-content",appendTo:".ajtodo_project_set",helper:"clone",revert:100,distance:50,scroll:!0,scrollSensitivity:100,start:function(o,a){var e;Lt=0,itemdown=1,lastClientX=o.clientX,t("#ajtodo_todotitle_add").hide(),t("#ajtodo_todotitle_input").hide(),console.log(t(a.item).clone()),Xt=t(a.item).attr("skey"),e=Xt,Et=i.find(t=>t.key===e).action,t.each(t(".ajtodo-board-column-content"),function(o,a){var e=t(a).attr("var");-1!==t.inArray(e,Et)||Xt==e?(t(a).removeClass("aj_drop_dis").addClass("aj_drop_ena"),t(a).parent().removeClass("aj_drop_dis").addClass("aj_drop_ena")):(t(a).removeClass("aj_drop_ena").addClass("aj_drop_dis"),t(a).parent().removeClass("aj_drop_ena").addClass("aj_drop_dis"))}),a.placeholder.height(a.item.height()),a.placeholder.css("visibility","visible"),a.placeholder.css("border-radius","4px"),a.placeholder.css("background","#f2f2f2"),a.placeholder.css("border","2px dashed #f0f0f0")},receive:function(o,a){t(this).hasClass("aj_drop_dis")&&a.sender.sortable("cancel")},stop:function(o,a){Lt=0,itemdown=0;var e=t(a.item).parent().attr("var"),n=t(a.item).attr("var"),d=t(a.item).attr("skey");if(t.each(t(".ajtodo-board-column-content"),function(o,a){t(a).removeClass("aj_drop_dis").removeClass("aj_drop_ena"),t(a).parent().removeClass("aj_drop_dis").removeClass("aj_drop_ena")}),t("#ajtodo_todotitle_add").show(),t("#ajtodo_todotitle_input").hide(),e!=d){F("closed"==e?{statuskey:e,donedated:":_NOW_:"}:{statuskey:e,donedated:":_NULL_:"},n,Wt)}"closed"==e?t(a.item).attr("isdone",""):t(a.item).removeAttr("isdone"),Jt()},over:function(o,a){t(o.target).parent().addClass("ajdroppable")},out:function(o,a){t(o.target).parent().removeClass("ajdroppable")},sort:function(t,o){}}).disableSelection(),t("#wpbody-content").css("padding-bottom",0),It(),t(window).resize(function(){It()}),t(".ajtodo-list-dock").sortable({connectWith:".ajtodo-list-dock",appendTo:".ajtodo-list-dock",axis:"x",opacity:.5,start:function(t,o){Lt=0,itemdown=1},stop:function(t,o){Lt=0,itemdown=0,Jt()}}).disableSelection();var Lt=0;itemdown=0,t("#aj_board_main").on({mousemove:function(o){var a=t("#ajtodo_project_set").scrollLeft(),e=0;Lt?(e=newScrollX=-lastClientX+(lastClientX=o.clientX),t("#ajtodo_project_set").scrollLeft(a-e)):itemdown},mousedown:function(t){Lt=1,lastClientX=t.clientX},mouseup:function(){Lt=0}})}});